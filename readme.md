https://habr.com/ru/company/oleg-bunin/blog/461829/
https://professorweb.ru/my/csharp/web/level3/3_1.php
_________________________________________________
![Diagram](https://i.imgur.com/izsjPer.jpg)

Механизм TCP предоставляет поток данных с предварительной установкой соединения, осуществляет повторный запрос данных в случае потери данных и устраняет дублирование при получении двух копий одного пакета, гарантируя тем самым, в отличие от UDP, целостность передаваемых данных и уведомление отправителя о результатах передачи.
 Реализации TCP обычно встроены в ядра ОС. Существуют реализации TCP, работающие в пространстве пользователя.
 Когда осуществляется передача от компьютера к компьютеру через Интернет, TCP работает на верхнем уровне между двумя конечными системами, например, браузером и веб-сервером. TCP осуществляет надёжную передачу потока байтов от одного процесса к другому. TCP реализует управление потоком, управление перегрузкой, рукопожатие, надёжную передачу.

С UDP компьютерные приложения могут посылать сообщения (в данном случае называемые датаграммами) другим хостам по IP-сети без необходимости предварительного сообщения для установки специальных каналов передачи или путей данных.

Если говорить очень грубо, то TCP — это протокол надежной доставки, а UDP — ненадежной.

Стандартный стек 2000-х выглядел как HTTP 1.1 поверх SSL. 
Современный стек — это HTTP 2.0, TLS 1.3, и все это поверх TCP.

В беспроводных сетях существуют:
 packet loss — примерно 0,6% пакетов, которые мы отправляем, теряются по пути;
 reordering — перестановка пакетов местами, в реальной жизни довольно редкое явление, но случается в 0,2% случаев;
 jitter — когда пакеты отправляются равномерно, а приходят очередями с задержкой примерно в 50 мс.
RTT (round-trip time)

___________________________________
UDP checklist
Если вы будете писать свой протокол, вам нужен чек лист:
https://i.imgur.com/zGFoXTP.jpg

Pacing.
Если очень просто, то чем дольше вы непрерывно посылаете пакеты в сеть, тем больше вероятность packet loss. Если пакеты проредить, то packet loss будет ниже.
#
MTU discovery.
MTU — это размер данных, которые вы можете переправить.
Отправляем пакеты с сервера на клиент, например, размером 1500. Если на пути встречается маршрутизатор, который не поддерживает этот размер MTU, он его фрагментирует.
#
Исправление ошибок обязательно.
#
Flow control и Congestion control.
Flow control — это некий механизм защиты от перегрузки. Получатель говорит, на какое количество данных у него реально есть место в буфере, чтобы он был готов их принять. Если передать сверх flow control или recv window, то эти пакеты просто будут выкинуты. Задача flow control — это back pressure от нагрузки, то есть просто кто-то не успевает вычитывать данные.
У congestion control совершенно другая задача. Механизмы схожие, но задача — спасти сеть от перегрузки.
#
Опционально можете поддержать IP Migration, TLP — это легко.
В TCP IP Migration — это невозможная вещь.
Если вы пишите свой UDP протокол, то очень просто, внедряя в каждый пакет connection ID (CUID), вы сможете его идентифицировать, даже если он пришел с другого IP-адреса.
#

Помните, что каналы асимметричны, и пока вы получаете данные от сервера, ваш upload может простаивать, пробуйте его использовать.
